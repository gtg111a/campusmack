<li id="post_<%= post.id %>" class="post">
  <% if signed_in? %>
      <div class="actions">
        <%= link_to('Edit', method("edit_#{post.postable_type.downcase}_#{post.type.downcase}_path").call(post.postable, post), :class => 'button') if can? :update, post %>
        <%= link_to('Delete', post, :method => :delete, :confirm => "Delete Post?", :class => 'button') if can? :destroy, post %>
        <%= link_to('Report Abuse', report_post_path(post), :class => 'button postreport', :id => "post_rep_#{post.id}") if can? :report, post %>
      </div>
  <% end %>
  <h4><%= link_to post.title, [post.postable, post] %></h4>
  <%= vote_buttons(post) %>
  <div class="content">
    <% if post.photo %>
      <div class="photo_post">
        <a class="photo snap_noshots" href="<%= post.photo.url(:large) %>"><img src="<%= post.photo.url(:medium) %>" alt=""/></a>
      </div>
    <% end %>
    <% if post.news_post && !post.news_post.image_file_name.blank? %>
      <div class="photo_post">
        <a class="photo snap_noshots" href="<%= post.news_post.image_url(:large) %>"><img src="<%= post.news_post.image_url(:medium) %>" alt=""/></a>
      </div>
    <% end %>
    <% if post.video %>
      <div class="video_post"><%= youtube_embed(post.video.url) %></div>
    <% end %>
    <% if post.news_post && !post.news_post.video_url.blank? %>
      <div class="video_post"><%= youtube_embed(post.news_post.video_url) %></div>
    <% end %>
    <%= link_to "News post", post.news_post.url unless post.news_post.blank? %>
    <div class="comments">
      <%= post.summary %>
      <% if !post.summary.nil? && !request.fullpath.include?("posts") %>
          <%= link_to " [more...]", [post.postable, post] %>
          <br/><br/>
      <% end %>
    </div>
  </div>
  <br class="clear"/>

  <div class="timestamp">
    posted <%= time_ago_in_words(post.created_at) %> ago by <%= post.user.try(:username) %>.
  </div>
  <br class="clear"/>

  <div style="float: right;">
    <%= link_to_if(current_user.present?, "Send as smack", share_through_email_form_post_path(post, :smack => true), :method => "GET", :remote => true) %>
    <br/>
    <%= render(:partial => "posts/facebook_share", :locals => {:post => post, :image => "facebook_32.png"}) %>
    <%= render(:partial => "posts/twitter_share", :locals => {:post => post, :image => "twitter_32.png"}) %>
    <%= link_to(image_tag("email.png", :border => 0, :size =>'32x32'), share_through_email_form_post_path(post), :method => "GET", :remote => true) %>
  </div>
</li>